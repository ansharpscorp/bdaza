# file: kv_set_secrets.py
# pip install azure-identity azure-keyvault-secrets

import os
from azure.identity import DefaultAzureCredential
from azure.keyvault.secrets import SecretClient

# Example:
# export KEYVAULT_URL="https://<your-kv-name>.vault.azure.net/"
# export APP_USERNAME="myuser@contoso.com"
# export APP_PASSWORD="SuperSecretPassword!"

KV_URL = os.environ["KEYVAULT_URL"]
USERNAME = os.environ["APP_USERNAME"]
PASSWORD = os.environ["APP_PASSWORD"]

credential = DefaultAzureCredential()
client = SecretClient(vault_url=KV_URL, credential=credential)

# Store both as secrets (simple + consistent)
client.set_secret("app-username", USERNAME)
client.set_secret("app-password", PASSWORD)

print("Secrets written: app-username, app-password")
